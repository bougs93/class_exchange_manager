# 결보강계획서 양식 - 템플릿 분석 보고서

## 📊 파일 정보

| 항목 | 값 |
|------|-----|
| **파일명** | 결보강계획서_양식.xlsx |
| **워크시트** | Sheet1 |
| **최대 행** | 39 |
| **최대 열** | 12 |
| **총 셀** | 416 |
| **추출일시** | 2025-10-27 23:26:22 |

---

## 🏷️ 인식된 테그 (Template Tags)

### 행 10 (테그 행)

| 열 | 위치 | 테그 | 설명 |
|-----|------|------|------|
| 0 | (10, 0) | `date(day)` | 결강일(요일) |
| 1 | (10, 1) | `period` | 결강 교시 |
| 2 | (10, 2) | `grade` | 학년 |
| 3 | (10, 3) | `class` | 반 |
| 4 | (10, 4) | `subject` | 과목 |
| 5 | (10, 5) | `teacher` | 교사명 |
| 6 | (10, 6) | `subject2` | 보강/수업변경 과목 |
| 7 | (10, 7) | `teacher2` | 보강/수업변경 성명 |
| 8 | (10, 8) | `date3(day3)` | 교체일(교체요일) |
| 9 | (10, 9) | `period3` | 교체 교시 |
| 10 | (10, 10) | `subject3` | 교체 과목 |
| 11 | (10, 11) | `teacher3` | 교체 교사 |
| 12 | (10, 12) | `remarks` | 비고 |

---

## 📋 레이아웃 구조

### 상단 섹션 (행 0-9)

```
행 1:   "결･보강 계획서"  (제목)
행 2:   (여백)
행 3:   "1. 결강교사 : " + 기타 항목 (수업계, 교감)
행 4:   "2. 결강기간 : "
행 5:   "3. 근무상황 : "
행 6:   "4. 결강사유(장소) :"
행 7:   "5. 결 · 보강 조치 사항"
행 8:   섹션 헤더
        "결 강" | "보강/수업변경" | "수업 교체" | "비고(참고사항)"
행 9:   컬럼 제목
        "결강일" | "교시" | "학년" | "반" | "과목" | "성명" |
        "과목" | "성명" | "교체일" | "교시" | "과목" | "성명"
행 10:  테그 행 ← **데이터 입력 시작 위치**
        date(day) | period | grade | class | subject | teacher |
        subject2 | teacher2 | date3(day3) | period3 | subject3 | teacher3 | remarks
```

### 데이터 섹션 (행 11-39)

- 행 11-39: 데이터 입력 영역 (약 29행)
- 각 행은 하나의 교체 기록 정보를 담음

---

## 🔄 데이터 매핑

### 결강 관련 데이터

```
결강일(날짜+요일):    date(day) 컬럼 (0번) → 행 11부터
결강 교시:           period 컬럼 (1번)
학년:                grade 컬럼 (2번)
반:                  class 컬럼 (3번)
과목:                subject 컬럼 (4번)
교사:                teacher 컬럼 (5번)
```

### 보강/수업변경 정보

```
과목:                subject2 컬럼 (6번)
교사명:              teacher2 컬럼 (7번)
```

### 수업 교체 정보

```
교체일(날짜+요일):    date3(day3) 컬럼 (8번)
교체 교시:           period3 컬럼 (9번)
교체 과목:           subject3 컬럼 (10번)
교체 교사:           teacher3 컬럼 (11번)
```

### 기타

```
비고:                remarks 컬럼 (12번)
```

---

## 💾 활용 방법

### 1단계: 템플릿 로드

```dart
final info = await ExcelTemplateService().pickAndExtractTemplate();
ref.read(excelTemplateProvider.notifier).setTemplate(info);
```

### 2단계: 테그 위치 활용

```dart
final template = ref.watch(excelTemplateProvider);

// 각 테그의 위치 확인
final dateLocation = template?.tagLocations['date(day)'];     // (10, 0)
final periodLocation = template?.tagLocations['period'];     // (10, 1)
// ...
```

### 3단계: 데이터 채우기

```dart
// 예: 결강일 셀에 데이터 입력
if (dateLocation != null) {
  final cellIndex = CellIndex.indexByColumnRow(
    columnIndex: dateLocation['col'],
    rowIndex: dateLocation['row'] + 1,  // 첫 번째 데이터 행
  );
  sheet.cell(cellIndex).value = '2024-01-15(월)';
}
```

---

## 📝 주요 특징

### ✅ 지원하는 포맷

- **복합 테그**: `date(day)`, `date3(day3)` - 날짜와 요일을 함께 입력
- **단순 테그**: `period`, `grade`, `class` 등 - 개별 항목만 입력

### ✅ 구조화된 레이아웃

- 명확한 섹션 구분
- 헤더와 테그 행으로 구조 파악 용이
- 29행의 데이터 입력 영역

### ✅ 확장성

- 필요시 더 많은 열 추가 가능
- 현재 사용 중인 모든 필수 테그 포함

---

## 🔍 JSON 서식 파일

생성된 파일: `lib/assets/templates/template_info.json`

**주요 정보**:
- 모든 셀 정보 (행, 열, 값)
- 테그 위치 맵핑
- 메타데이터

---

## 📞 다음 단계

1. ✅ **템플릿 분석 완료** - 구조와 테그 파악
2. 🚀 **출력 기능 구현** - 데이터 채우기
3. 📁 **파일 저장** - 완성된 엑셀 파일 저장
4. 📊 **결과 검증** - 생성된 파일 검토

---

## 💡 참고사항

- 템플릿은 **행 10에서 테그 행**으로 설정
- 실제 데이터는 **행 11부터 입력**됨
- 최대 **약 29행**까지 데이터 입력 가능
- 각 테그의 정확한 **열 위치(0-12)**는 고정됨
